#!/bin/bash

if [ $# -eq 0 ]; then
  echo "usage: omarchy-iso-sign [release/omarchy.iso]"
  exit 1
fi

if ! pacman -q gnupg >/dev/null; then
  sudo pacman -s --noconfirm --needed --quiet gnupg
  echo "you'll need to generate a new key with: gpg --full-generate-key"
fi

gnupg-user-key=$(gpg --list-secret-keys --keyid-format=long | awk '/^[[:space:]]/{print $1; exit}')

gpg --local-user $gnupg-user-key --output $2.sig --detach-sig $2
